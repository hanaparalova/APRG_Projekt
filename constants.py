S_BOX = [["63", "7c", "77", "7b", "f2", "6b", "6f", "c5", "30", "01", "67", "2b", "fe", "d7", "ab", "76"],
         ["ca", "82", "c9", "7d", "fa", "59", "47", "f0", "ad", "d4", "a2", "af", "9c", "a4", "72", "c0"],
         ["b7", "fd", "93", "26", "36", "3f", "f7", "cc", "34", "a5", "e5", "f1", "71", "d8", "31", "15"],
         ["04", "c7", "23", "c3", "18", "96", "05", "9a", "07", "12", "80", "e2", "eb", "27", "b2", "75"],
         ["09", "83", "2c", "1a", "1b", "6e", "5a", "a0", "52", "3b", "d6", "b3", "29", "e3", "2f", "84"],
         ["53", "d1", "00", "ed", "20", "fc", "b1", "5b", "6a", "cb", "be", "39", "4a", "4c", "58", "cf"],
         ["d0", "ef", "aa", "fb", "43", "4d", "33", "85", "45", "f9", "02", "7f", "50", "3c", "9f", "a8"],
         ["51", "a3", "40", "8f", "92", "9d", "38", "f5", "bc", "b6", "da", "21", "10", "ff", "f3", "d2"],
         ["cd", "0c", "13", "ec", "5f", "97", "44", "17", "c4", "a7", "7e", "3d", "64", "5d", "19", "73"],
         ["60", "81", "4f", "dc", "22", "2a", "90", "88", "46", "ee", "b8", "14", "de", "5e", "0b", "db"],
         ["e0", "32", "3a", "0a", "49", "06", "24", "5c", "c2", "d3", "ac", "62", "91", "95", "e4", "79"],
         ["e7", "c8", "37", "6d", "8d", "d5", "4e", "a9", "6c", "56", "f4", "ea", "65", "7a", "ae", "08"],
         ["ba", "78", "25", "2e", "1c", "a6", "b4", "c6", "e8", "dd", "74", "1f", "4b", "bd", "8b", "8a"],
         ["70", "3e", "b5", "66", "48", "03", "f6", "0e", "61", "35", "57", "b9", "86", "c1", "1d", "9e"],
         ["e1", "f8", "98", "11", "69", "d9", "8e", "94", "9b", "1e", "87", "e9", "ce", "55", "28", "df"],
         ["8c", "a1", "89", "0d", "bf", "e6", "42", "68", "41", "99", "2d", "0f", "b0", "54", "bb", "16"]]

INVERSE_S_BOX = [["52", "09", "6a", "d5", "30", "36", "a5", "38", "bf", "40", "a3", "9e", "81", "f3", "d7", "fb"],
                 ["7c", "e3", "39", "82", "9b", "2f", "ff", "87", "34", "8e", "43", "44", "c4", "de", "e9", "cb"],
                 ["54", "7b", "94", "32", "a6", "c2", "23", "3d", "ee", "4c", "95", "0b", "42", "fa", "c3", "4e"],
                 ["08", "2e", "a1", "66", "28", "d9", "24", "b2", "76", "5b", "a2", "49", "6d", "8b", "d1", "25"],
                 ["72", "f8", "f6", "64", "86", "68", "98", "16", "d4", "a4", "5c", "cc", "5d", "65", "b6", "92"],
                 ["6c", "70", "48", "50", "fd", "ed", "b9", "da", "5e", "15", "46", "57", "a7", "8d", "9d", "84"],
                 ["90", "d8", "ab", "00", "8c", "bc", "d3", "0a", "f7", "e4", "58", "05", "b8", "b3", "45", "06"],
                 ["d0", "2c", "1e", "8f", "ca", "3f", "0f", "02", "c1", "af", "bd", "03", "01", "13", "8a", "6b"],
                 ["3a", "91", "11", "41", "4f", "67", "dc", "ea", "97", "f2", "cf", "ce", "f0", "b4", "e6", "73"],
                 ["96", "ac", "74", "22", "e7", "ad", "35", "85", "e2", "f9", "37", "e8", "1c", "75", "df", "6e"],
                 ["47", "f1", "1a", "71", "1d", "29", "c5", "89", "6f", "b7", "62", "0e", "aa", "18", "be", "1b"],
                 ["fc", "56", "3e", "4b", "c6", "d2", "79", "20", "9a", "db", "c0", "fe", "78", "cd", "5a", "f4"],
                 ["1f", "dd", "a8", "33", "88", "07", "c7", "31", "b1", "12", "10", "59", "27", "80", "ec", "5f"],
                 ["60", "51", "7f", "a9", "19", "b5", "4a", "0d", "2d", "e5", "7a", "9f", "93", "c9", "9c", "ef"],
                 ["a0", "e0", "3b", "4d", "ae", "2a", "f5", "b0", "c8", "eb", "bb", "3c", "83", "53", "99", "61"],
                 ["17", "2b", "04", "7e", "ba", "77", "d6", "26", "e1", "69", "14", "63", "55", "21", "0c", "7d"]]

RCON = ["01", "02", "04", "08", "10", "20", "40", "80", "1b", "36"]

E_TABLE = [["01", "03", "05", "0f", "11", "33", "55", "ff", "1a", "2e", "72", "96", "a1", "f8", "13", "35"],
           ["5f", "e1", "38", "48", "d8", "73", "95", "a4", "f7", "02", "06", "0a", "1e", "22", "66", "aa"],
           ["e5", "34", "5c", "e4", "37", "59", "eb", "26", "6a", "be", "d9", "70", "90", "ab", "e6", "31"],
           ["53", "f5", "04", "0c", "14", "3c", "44", "cc", "4f", "d1", "68", "b8", "d3", "6e", "b2", "cd"],
           ["4c", "d4", "67", "a9", "e0", "3b", "4d", "d7", "62", "a6", "f1", "08", "18", "28", "78", "88"],
           ["83", "9e", "b9", "d0", "6b", "bd", "dc", "7f", "81", "98", "b3", "ce", "49", "dB", "76", "9a"],
           ["b5", "c4", "57", "f9", "10", "30", "50", "f0", "0b", "1d", "27", "69", "bb", "d6", "61", "a3"],
           ["fe", "19", "2b", "7d", "87", "92", "da", "ec", "2f", "71", "93", "ae", "e9", "20", "60", "a0"],
           ["fb", "16", "3a", "4e", "d2", "6d", "b7", "c2", "5d", "e7", "32", "56", "fa", "15", "3f", "41"],
           ["c3", "5e", "e2", "3d", "47", "c9", "40", "c0", "5b", "ed", "2c", "74", "9c", "bf", "da", "75"],
           ["9f", "ba", "d5", "64", "ac", "ef", "2a", "7e", "82", "9d", "cb", "df", "7a", "8e", "89", "80"],
           ["9b", "b6", "c1", "58", "e8", "23", "65", "af", "ea", "25", "6f", "b1", "c8", "43", "c5", "54"],
           ["fc", "1f", "21", "63", "a5", "f4", "07", "09", "1b", "2d", "77", "99", "b0", "cb", "46", "ca"],
           ["45", "cf", "4a", "de", "79", "8b", "86", "91", "a8", "e3", "3e", "42", "c6", "51", "f3", "0e"],
           ["12", "36", "5a", "ee", "29", "7b", "8d", "8c", "8f", "8a", "85", "94", "a7", "f2", "0d", "17"],
           ["39", "4b", "dd", "7c", "84", "97", "a2", "fd", "1c", "24", "6c", "b4", "c7", "52", "f6", "01"]]

L_TABLE = [["00", "00", "19", "01", "32", "02", "1a", "c6", "4b", "c7", "1b", "68", "33", "ee", "df", "03"],
           ["64", "04", "e0", "0e", "34", "8d", "81", "ef", "4c", "71", "08", "c8", "f8", "69", "1c", "c1"],
           ["7d", "c2", "1d", "b5", "f9", "b9", "27", "6a", "4d", "e4", "a6", "72", "9a", "c9", "09", "78"],
           ["65", "2f", "8a", "05", "21", "0f", "e1", "24", "12", "f0", "82", "45", "35", "93", "da", "8e"],
           ["96", "8f", "db", "bd", "36", "d0", "ce", "94", "13", "5c", "d2", "f1", "40", "46", "83", "38"],
           ["66", "dd", "fd", "30", "bf", "06", "8b", "62", "b3", "25", "e2", "98", "22", "88", "91", "10"],
           ["7e", "6e", "48", "c3", "a3", "b6", "1e", "42", "3a", "6b", "28", "54", "fa", "85", "3d", "ba"],
           ["2b", "79", "0a", "15", "9b", "9f", "5e", "ca", "4e", "d4", "ac", "e5", "f3", "73", "a7", "57"],
           ["af", "58", "a8", "50", "f4", "ea", "d6", "74", "4f", "ae", "e9", "d5", "e7", "e6", "ad", "e8"],
           ["2c", "d7", "75", "7a", "eb", "16", "0b", "f5", "59", "cb", "5f", "b0", "9c", "a9", "51", "a0"],
           ["7f", "0c", "f6", "6f", "17", "c4", "49", "ec", "d8", "43", "1f", "2d", "a4", "76", "7b", "b7"],
           ["cc", "bb", "3e", "5a", "fb", "60", "b1", "86", "3b", "52", "a1", "6c", "aa", "55", "29", "9d"],
           ["97", "b2", "87", "90", "61", "be", "dc", "fc", "bc", "95", "cf", "cd", "37", "3f", "5b", "d1"],
           ["53", "39", "84", "3c", "41", "a2", "6d", "47", "14", "2a", "9e", "5d", "56", "f2", "d3", "ab"],
           ["44", "11", "92", "d9", "23", "20", "2e", "89", "b4", "7c", "b8", "26", "77", "99", "e3", "a5"],
           ["67", "4a", "ed", "de", "c5", "31", "fe", "18", "0d", "63", "8c", "80", "c0", "f7", "70", "07"]]

mult9 = [["00", "09", "12", "1b", "24", "2d", "36", "3f", "48", "41", "5a", "53", "6c", "65", "7e", "77"],
         ["90", "99", "82", "8b", "b4", "bd", "a6", "af", "d8", "d1", "ca", "c3", "fc", "f5", "ee", "e7"],
         ["3b", "32", "29", "20", "1f", "16", "0d", "04", "73", "7a", "61", "68", "57", "5e", "45", "4c"],
         ["ab", "a2", "b9", "b0", "8f", "86", "9d", "94", "e3", "ea", "f1", "f8", "c7", "ce", "d5", "dc"],
         ["76", "7f", "64", "6d", "52", "5b", "40", "49", "3e", "37", "2c", "25", "1a", "13", "08", "01"],
         ["e6", "ef", "f4", "fd", "c2", "cb", "d0", "d9", "ae", "a7", "bc", "b5", "8a", "83", "98", "91"],
         ["4d", "44", "5f", "56", "69", "60", "7b", "72", "05", "0c", "17", "1e", "21", "28", "33", "3a"],
         ["dd", "d4", "cf", "c6", "f9", "f0", "eb", "e2", "95", "9c", "87", "8e", "b1", "b8", "a3", "aa"],
         ["ec", "e5", "fe", "f7", "c8", "c1", "da", "d3", "a4", "ad", "b6", "bf", "80", "89", "92", "9b"],
         ["7c", "75", "6e", "67", "58", "51", "4a", "43", "34", "3d", "26", "2f", "10", "19", "02", "0b"],
         ["d7", "de", "c5", "cc", "f3", "fa", "e1", "e8", "9f", "96", "8d", "84", "bb", "b2", "a9", "a0"],
         ["47", "4e", "55", "5c", "63", "6a", "71", "78", "0f", "06", "1d", "14", "2b", "22", "39", "30"],
         ["9a", "93", "88", "81", "be", "b7", "ac", "a5", "d2", "db", "c0", "c9", "f6", "ff", "e4", "ed"],
         ["0a", "03", "18", "11", "2e", "27", "3c", "35", "42", "4b", "50", "59", "66", "6f", "74", "7d"],
         ["a1", "a8", "b3", "ba", "85", "8c", "97", "9e", "e9", "e0", "fb", "f2", "cd", "c4", "df", "d6"],
         ["31", "38", "23", "2a", "15", "1c", "07", "0e", "79", "70", "6b", "62", "5d", "54", "4f", "46"]]

mult11 = [["00", "0b", "16", "1d", "2c", "27", "3a", "31", "58", "53", "4e", "45", "74", "7f", "62", "69"],
          ["b0", "bb", "a6", "ad", "9c", "97", "8a", "81", "e8", "e3", "fe", "f5", "c4", "cf", "d2", "d9"],
          ["7b", "70", "6d", "66", "57", "5c", "41", "4a", "23", "28", "35", "3e", "0f", "04", "19", "12"],
          ["cb", "c0", "dd", "d6", "e7", "ec", "f1", "fa", "93", "98", "85", "8e", "bf", "b4", "a9", "a2"],
          ["f6", "fd", "e0", "eb", "da", "d1", "cc", "c7", "ae", "a5", "b8", "b3", "82", "89", "94", "9f"],
          ["46", "4d", "50", "5b", "6a", "61", "7c", "77", "1e", "15", "08", "03", "32", "39", "24", "2f"],
          ["8d", "86", "9b", "90", "a1", "aa", "b7", "bc", "d5", "de", "c3", "c8", "f9", "f2", "ef", "e4"],
          ["3d", "36", "2b", "20", "11", "1a", "07", "0c", "65", "6e", "73", "78", "49", "42", "5f", "54"],
          ["f7", "fc", "e1", "ea", "db", "d0", "cd", "c6", "af", "a4", "b9", "b2", "83", "88", "95", "9e"],
          ["47", "4c", "51", "5a", "6b", "60", "7d", "76", "1f", "14", "09", "02", "33", "38", "25", "2e"],
          ["8c", "87", "9a", "91", "a0", "ab", "b6", "bd", "d4", "df", "c2", "c9", "f8", "f3", "ee", "e5"],
          ["3c", "37", "2a", "21", "10", "1b", "06", "0d", "64", "6f", "72", "79", "48", "43", "5e", "55"],
          ["01", "0a", "17", "1c", "2d", "26", "3b", "30", "59", "52", "4f", "44", "75", "7e", "63", "68"],
          ["b1", "ba", "a7", "ac", "9d", "96", "8b", "80", "e9", "e2", "ff", "f4", "c5", "ce", "d3", "d8"],
          ["7a", "71", "6c", "67", "56", "5d", "40", "4b", "22", "29", "34", "3f", "0e", "05", "18", "13"],
          ["ca", "c1", "dc", "d7", "e6", "ed", "f0", "fb", "92", "99", "84", "8f", "be", "b5", "a8", "a3"]]

mult13 = [["00", "0d", "1a", "17", "34", "39", "2e", "23", "68", "65", "72", "7f", "5c", "51", "46", "4b"],
          ["d0", "dd", "ca", "c7", "e4", "e9", "fe", "f3", "b8", "b5", "a2", "af", "8c", "81", "96", "9b"],
          ["bb", "b6", "a1", "ac", "8f", "82", "95", "98", "d3", "de", "c9", "c4", "e7", "ea", "fd", "f0"],
          ["6b", "66", "71", "7c", "5f", "52", "45", "48", "03", "0e", "19", "14", "37", "3a", "2d", "20"],
          ["6d", "60", "77", "7a", "59", "54", "43", "4e", "05", "08", "1f", "12", "31", "3c", "2b", "26"],
          ["bd", "b0", "a7", "aa", "89", "84", "93", "9e", "d5", "d8", "cf", "c2", "e1", "ec", "fb", "f6"],
          ["d6", "db", "cc", "c1", "e2", "ef", "f8", "f5", "be", "b3", "a4", "a9", "8a", "87", "90", "9d"],
          ["06", "0b", "1c", "11", "32", "3f", "28", "25", "6e", "63", "74", "79", "5a", "57", "40", "4d"],
          ["da", "d7", "c0", "cd", "ee", "e3", "f4", "f9", "b2", "bf", "a8", "a5", "86", "8b", "9c", "91"],
          ["0a", "07", "10", "1d", "3e", "33", "24", "29", "62", "6f", "78", "75", "56", "5b", "4c", "41"],
          ["61", "6c", "7b", "76", "55", "58", "4f", "42", "09", "04", "13", "1e", "3d", "30", "27", "2a"],
          ["b1", "bc", "ab", "a6", "85", "88", "9f", "92", "d9", "d4", "c3", "ce", "ed", "e0", "f7", "fa"],
          ["b7", "ba", "ad", "a0", "83", "8e", "99", "94", "df", "d2", "c5", "c8", "eb", "e6", "f1", "fc"],
          ["67", "6a", "7d", "70", "53", "5e", "49", "44", "0f", "02", "15", "18", "3b", "36", "21", "2c"],
          ["0c", "01", "16", "1b", "38", "35", "22", "2f", "64", "69", "7e", "73", "50", "5d", "4a", "47"],
          ["dc", "d1", "c6", "cb", "e8", "e5", "f2", "ff", "b4", "b9", "ae", "a3", "80", "8d", "9a", "97"]]

mult14 = [["00", "0e", "1c", "12", "38", "36", "24", "2a", "70", "7e", "6c", "62", "48", "46", "54", "5a"],
          ["e0", "ee", "fc", "f2", "d8", "d6", "c4", "ca", "90", "9e", "8c", "82", "a8", "a6", "b4", "ba"],
          ["db", "d5", "c7", "c9", "e3", "ed", "ff", "f1", "ab", "a5", "b7", "b9", "93", "9d", "8f", "81"],
          ["3b", "35", "27", "29", "03", "0d", "1f", "11", "4b", "45", "57", "59", "73", "7d", "6f", "61"],
          ["ad", "a3", "b1", "bf", "95", "9b", "89", "87", "dd", "d3", "c1", "cf", "e5", "eb", "f9", "f7"],
          ["4d", "43", "51", "5f", "75", "7b", "69", "67", "3d", "33", "21", "2f", "05", "0b", "19", "17"],
          ["76", "78", "6a", "64", "4e", "40", "52", "5c", "06", "08", "1a", "14", "3e", "30", "22", "2c"],
          ["96", "98", "8a", "84", "ae", "a0", "b2", "bc", "e6", "e8", "fa", "f4", "de", "d0", "c2", "cc"],
          ["41", "4f", "5d", "53", "79", "77", "65", "6b", "31", "3f", "2d", "23", "09", "07", "15", "1b"],
          ["a1", "af", "bd", "b3", "99", "97", "85", "8b", "d1", "df", "cd", "c3", "e9", "e7", "f5", "fb"],
          ["9a", "94", "86", "88", "a2", "ac", "be", "b0", "ea", "e4", "f6", "f8", "d2", "dc", "ce", "c0"],
          ["7a", "74", "66", "68", "42", "4c", "5e", "50", "0a", "04", "16", "18", "32", "3c", "2e", "20"],
          ["ec", "e2", "f0", "fe", "d4", "da", "c8", "c6", "9c", "92", "80", "8e", "a4", "aa", "b8", "b6"],
          ["0c", "02", "10", "1e", "34", "3a", "28", "26", "7c", "72", "60", "6e", "44", "4a", "58", "56"],
          ["37", "39", "2b", "25", "0f", "01", "13", "1d", "47", "49", "5b", "55", "7f", "71", "63", "6d"],
          ["d7", "d9", "cb", "c5", "ef", "e1", "f3", "fd", "a7", "a9", "bb", "b5", "9f", "91", "83", "8d"]]


def x_or(mat_1, mat_2):
    """This make the XOR operation over two matrixes."""
    xor = ""
    xored = []
    for i in range(4):
        a = "{0:08b}".format(int(mat_1[i], 16))
        b = "{0:08b}".format(int(mat_2[i], 16))
        for j in range(0, 8):
            if a[j] == b[j]:
                xor = xor + "0"
            else:
                xor = xor + "1"
        back = "{0:02x}".format(int(xor, 2))
        xored.append(back)
        xor = ""
    return xored
